<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <title>AdVideoPlayer</title>
</head>
<body onload="bodyLoaded()">

    <script src="js/TaxiInteractiveUtils.js"></script>
    <script src="js/jquery.min.js"></script>

    <!-- Container ID is constant could not be changed. -->
    <div id="im_box_ep" style="width:640px; height:360px"></div>
    <!-- Container shouldbe loaded first -->




    <script type="text/javascript" src="//www.oculu.com/im4/im_initiate.php?key=851f7b4608ec16347fb1f1c572b6348d&auto_ep=1022513423"></script>


    <script>

        
        function bodyLoaded() {

            TaxiInteractiveUtils.initialize();

            setTimeout(function () {
                TaxiInteractiveUtils.broadcastMessage("invokeJSMethod",{name:"autoPlayMedia"});
            },500);

            setTimeout(function () {
                TaxiInteractiveUtils.broadcastMessage("invokeJSMethod",{name:"autoPlayMedia"});
            },1500);

            setTimeout(function () {
                TaxiInteractiveUtils.broadcastMessage("invokeJSMethod",{name:"autoPlayMedia"});
            },2500);
        }

        function getFormattedTime(){
            var date = new Date();
            return to2digit(date.getHours()+":"+date.getMinutes()+":"+date.getSeconds()+":"+date.getMilliseconds());
        }
        
        function to2digit(value) {
            if(value<10){
                return "0"+value;
            }

            return String(value);
        }

        // Listen for playback state changes
        window.im_PlayerEventListener = function(im_event){
            /*** im_event values
             ** start
             ** pause
             ** play
             ** end
             ** */

            switch (im_event){

                case "AD_IMPRESSION":
                    //$("#im_box_ep").show();
                break;

                case "AD_START":

                break;

                case "AD_COMPLETE":
                    $(".im_video-controls").fadeOut();
                    TaxiInteractiveUtils.broadcastMessage("programatic_video_ad_complete");
                break;

                case "AD_ERROR":

                break;

            }

            console.warn("[" +  getFormattedTime()+  "] " + "im_event: "+ im_event);
        };

        window.im_get_playHead = function(some_vars){
            console.log("Playhead:"+some_vars);
        };

        function startMonitoringPlayer() {
          window.timerId = setInterval(function () {
              $(".im_video-controls").hide();
          }, 100);
        }
        
        //starts ad video playback
        window.autoPlayMedia = function () {
            //$("#im_startAsset").trigger('click');
            //im_html5_asset('1022513423','ep');
            $("#im_box_ep").children().trigger("click");
            //alert("$('#im_startAsset').length="+$("#im_startAsset").length);
        }

    </script>


</body>
</html>